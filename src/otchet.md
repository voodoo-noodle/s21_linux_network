# Linux Network

## Part 1

### 1.1
1) Адрес сети 192.167.38.54/13
		192.160.0.0/13

3) Перевод маски 255.255.255.0 в префиксную и двоичную запись, /15 в обычную и двоичную, 11111111.11111111.11111111.11110000 в обычную и префиксную

	Перевод маски 255.255.255.0:
	
	Двоичная запись == 11111111.11111111.11111111.00000000
	Префиксная запись == /24
	
	Перевод маски /15:

	Двоичная запись == 111111111.11111110.00000000.00000000
	Обычная запись == 255.254.0.0

	Перевод маски  11111111.11111111.11111111.11110000:

	Обычная запись == 255.255.255.240
	Префиксная запись == /28
		
		

5) Минимальный и максимальный хост в сети 12.167.38.4 при масках: /8, 11111111.11111111.00000000.00000000, 255.255.254.0 и /4

	12.167.38.4/8

	HostMin == 12.0.0.1
	HostMax == 12.255.255.254

	12.167.38.4/16

	HostMin == 12.167.0.1
	HostMax == 12.167.255.254

	12.167.38.4/23

	HostMin == 12.167.38.1
	HostMax == 12.167.39.254

	12.167.38.4/4

	HostMin == 0.0.0.1
	HostMax == 15.255.255.254

### 1.2

"*Наиболее широко используемый IP адрес в механизмах loopback — 127.0.0.1. В IPv4, в него также отражается любой адрес в пределах от 127.0.0.0 до 127.255.255.255. Стандартное, официально зарезервированное, доменное имя для этих адресов — localhost"

Следовательно среди данных адресов: 194.34.23.100, 127.0.0.2, 127.1.0.1, 128.0.0.1, обратяться к localhost только 127.0.0.2 и 127.1.0.1

### 1.3

![](screenshots/20240402153500.png)

Среди адрессов: _10.0.0.45_, _134.43.0.2_, _192.168.4.2_, _172.20.250.4_, _172.0.2.1_, _192.172.0.1_, _172.68.0.2_, _172.16.255.255_, _10.10.10.10_, _192.169.168.1_

Частные: _10.0.0.45_ ; _192.168.4.2_ ; _172.20.250.4_ ; _172.16.255.255_ ; _10.10.10.10.

Для адреса 10.10.0.0/18 :

	Hostmin == 10.10.0.1
	Hostmax == 10.10.63.254

Следовательно, из возможных шлюзов  _10.0.0.1_, _10.10.0.2_, _10.10.10.10_, _10.10.100.1_, _10.10.1.255_
могут являтся шлюхами: _10.10.0.2_ ; _10.10.10.10_ ; _10.10.1.255_ ;

## Part 2

### 2.1

ip a внутри ws1:

![](screenshots/20240404184232.png)

ip a внутри ws2:

![](screenshots/20240404184444.png)

lo ==  Любой трафик, который посылается компьютерной программой на интерфейс loopback, тут же получается тем же интерфейсом (адрес localhost).

enp0s3 == Сетевой адаптер ethernet

enp0s8 == Доступ к локальной сети (Добавили локальную сеть в адаптерах сети внутри VM)

Выставление IP адресов:

	ws1

![](screenshots/20240404185109.png)

	ws2

![](screenshots/20240404134353.png)
Сверху dchp4: false, извините
Добавляем route соответствуеющие адреса:

	ws1

![](screenshots/20240404202029.png)

	ws2

![](screenshots/20240404203528.png)

Для обеих vm:

![](screenshots/20240404204802.png)

Так как моя версия Ubuntu 22.04.4, что отличается от необходимой в проекте (прошу прощения, впадлу переделывать, так как разница минимальна), вылетает предупреждение об отсуствии ovsdb-server.service, что никак не влияет на работу.

Пингуем:

	ws1

![](screenshots/20240404210638.png)

	ws2

![](screenshots/20240404210708.png)

Устанавливаем постоянное соединение через netplan:

![](screenshots/20240407133159.png)

Указание маски сети в маршруте -- ошибка.

Пинг на ws1:

![](screenshots/20240407135558.png)

Пинг на ws2:

![](screenshots/20240407135638.png)
## Part 3

1. Скорость 8 мегабит в секунду эквивалентна 1 мегабайту в секунду.
2. Скорость 100 мегабайт в секунду эквивалентна 800000 килобитам в секунду.
3. Скорость 1 гигабит в секунду эквивалентна 1000 мегабитам в секунду.


Проверяем скорость соединение между ws1 (iperf3 -s -f K, т.е. "слушаем на порту 5201")
и ws2 (iperf3 -c 192.168.100.10, т.е. отправляем запрос на слушающую ws2)

ws1:

![](screenshots/20240407142343.png)

ws2

![](screenshots/20240407142418.png)

## Part 4

ws1

![](screenshots/20240408162836.png)
![](screenshots/20240408162952.png)

Итоговые правила:

![](screenshots/20240408163631.png)

ws2

![](screenshots/20240408164058.png)
![](screenshots/20240408164137.png)

Итоговые правила:

![](screenshots/20240408164434.png)

Пинг первой машины ws1:

![](screenshots/20240408164958.png)

Пинг ws2:

![](screenshots/20240408165119.png)

Первая машина пингуется, а вторая -- нет. Принятие echo reply зависит от того, какое правило первое. Если первое правило запрещающее, то правило принятие не рассматривается и наоборот.

Nmap

![](screenshots/20240408165628.png)

## Part 5

ws11

![](screenshots/20240409130837.png)

r1

![](screenshots/20240409131702.png)

Пропинговали ws1 r1

![](screenshots/20240409134707.png)

r2

![](screenshots/20240409140116.png)

ws 22

![](screenshots/20240409140841.png)

ws 21

![](screenshots/20240409151806.png)

Пинг ws21 и r2

![](screenshots/20240409152039.png)

ip -4 a

Для ws11:

![](screenshots/20240409152532.png)


Для ws21 ws22:

![](screenshots/20240409152457.png)

Для r1 r2:

![](screenshots/20240409152722.png)

Установка маршрута:

![](screenshots/20240409161543.png)
![](screenshots/20240409161647.png)

Установка маршрута по-умолчанию:

r1

![](screenshots/20240409162158.png)

r2

![](screenshots/20240409162301.png)

Меняем маршруты рабочих станций:

![](screenshots/20240409174748.png)
![](screenshots/20240409175827.png)

Пингуем r1 в ws1:

![](screenshots/20240409195457.png)

получили на r2 echo request

![](screenshots/20240409195525.png)

Проверяем routes с помощью ip r:

ws11:

![](screenshots/20240409181937.png)

ws21:

![](screenshots/20240409181900.png)

ws22:

![](screenshots/20240409182007.png)

Добавляем адрес в соседнюю сеть в роутерах:

r1:

![](screenshots/20240409200830.png)

r2:

![](screenshots/20240409200935.png)

ip r для r1:

![](screenshots/20240409201028.png)

ip r для r2:

![](screenshots/20240409201054.png)

Для адреса 10.10.0.0/18 не был выбран маршрут 0.0.0.0/0, потому что пакеты отправляется на него только тогда, когда другой маршрут не задан явным образом в таблице маршрутизации 
хоста. Так как ws11 находится внутри сети 10.10.0.0/18, то для связи с ней она использует 
свой IP-адрес 10.10.0.2. Адрес 0.0.0.0/0 находится в другой сети, поэтому ws1 отправляет 
данные на роутер, используя маршрут по умолчанию, прописанный в файле конфигурации (10.10.0.1)

traceroute c ws11 на ws21

![](screenshots/20240411191753.png)

запрос посылается на через r1 (10.10.0.1), который пересылает его в cеть 10.20.0.0 на шлюз 10.20.0.10 через r2 (10.100.0.12)

tcpdump -tnv -i eth0 на r1:

![](screenshots/20240411191926.png)

Пинг ws11 на адрес 10.30.0.111

![](screenshots/20240412113224.png)

Прослушивание icmp пакетов на r1

![](screenshots/20240412113306.png)

## Part 6

Изменил в neplan ws21 ws22 r2 dhcp4 c false на true

r2 dhcpd.conf

![](screenshots/20240412115036.png)

r2 resolv.conf

![](screenshots/20240414160458.png)

Перезапускаем dhcp сервер на r2

![](screenshots/20240414183624.png)

Перезагрзив систему на ws21 получаем новый ip == 10.20.0.3

![](screenshots/20240414183714.png)

Пинг ws21 с ws22

![](screenshots/20240414184005.png)

Измененный netplan ws11

![](screenshots/20240414184145.png)

Настраиваем r1

![](screenshots/20240414184515.png)

![](screenshots/20240414200819.png)

Перезапускаем ws11 

![](screenshots/20240414200934.png)

ip адрес изменился на фиксированный 10.10.0.7, который указан в dhcpd.conf r1

ws21 до

![](screenshots/20240414201344.png)

Вводим 
	dhclient -r (освобождение старых ip) 
	dhclient (получение нового)

ws21 после

![](screenshots/20240414201612.png)

Получили ip адресс 10.20.0.5

## Part 7

Следующие несколько скринов идентичны дня ws22 и r1

![](screenshots/20240415104806.png)
![](screenshots/20240415105218.png)
![](screenshots/20240415105237.png)

Запускаем фаервол

![](screenshots/20240415112601.png)
![](screenshots/20240415112954.png)

Пинг с r1 ws22:

![](screenshots/20240416130559.png)


Добавляем разрешение icmp пакетов

![](screenshots/20240415174357.png)

![](screenshots/20240416130752.png)

Правила для r2:

![](screenshots/20240416175409.png)

r1 к ws22

![](screenshots/20240416175717.png)

ws22 к r1

![](screenshots/20240416185727.png)


r1 к ws22 через порт 8080 на r2

![](screenshots/20240416190543.png)

## Part 8

![](screenshots/20240416192424.png)

Также поставили разрешение пересылки всез пакетов в правилах r1

подключениe Local TCP forwarding

![](screenshots/20240416192403.png)

Пингуем

![](screenshots/20240416204209.png)

подключение Remote TCP forwarding

![](screenshots/20240416202957.png)

Пингуем

![](screenshots/20240416203318.png)

